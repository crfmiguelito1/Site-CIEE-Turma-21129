<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Treinamento: Padronização de Processos</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap');
        body { font-family: 'Montserrat', sans-serif; background-color: #f8f9fa; }
        .progress-bar { transition: width 0.2s ease-in-out; }
        .course-card { background-color: #ffffff; border-radius: 12px; padding: 2.5rem; box-shadow: 0 8px 16px rgba(0,0,0,0.05); margin-top: 1.5rem; border: 1px solid #e5e7eb; }
        .tab-button { padding: 1rem 1.5rem; font-weight: 600; color: #6b7280; border-bottom: 3px solid transparent; transition: all 0.3s ease; }
        .tab-button:hover { background-color: #f9fafb; color: #4f46e5; }
        .active-tab { color: #6A1B9A; border-bottom-color: #6A1B9A; }
        .prose-styling p { font-size: 1.1rem; line-height: 1.8; color: #374151; }
        .prose-styling h3 { font-size: 1.5rem; font-weight: 700; margin-top: 1.5rem; color: #1f2937; }
        .dark .prose-styling h3 { color: #f9fafb; }


        
        button:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
            opacity: 0.7;
        }
        button:disabled:hover {
            background-color: #9ca3af;
            transform: none;
        }

        /* --- ESTILOS DO QUIZ --- */
        .option-btn {
            transition: all 0.2s ease;
            border: 2px solid #e5e7eb;
            background-color: #f9fafb;
            color: #374151;
        }
        .option-btn:hover:not(.disabled) { 
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            background-color: #f3f4f6;
        }
        .disabled {
            pointer-events: none;
            opacity: 0.8;
            transform: none !important;
            box-shadow: none !important;
        }
        .correct { border: 2px solid #10b981 !important; background-color: #d1fae5 !important; color: #065f46 !important; }
        .incorrect { border: 2px solid #ef4444 !important; background-color: #fee2e2 !important; color: #991b1b !important; }
        
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.4s ease-out;
        }

        
        .dark body { background-color: #111827; color: #d1d5db; }
        .dark .card, .dark .course-card { background-color: #1f2937; border: 1px solid #374151; }
        .dark h1, .dark h2, .dark h3, .dark h4, .dark p, .dark span, .dark h6 { color: #f9fafb; }
        .dark .sidebar { background-color: #1f2937; border-right: 1px solid #374151; }
        .dark .text-gray-500, .dark .text-gray-600 { color: #9ca3af; }
        .dark .tab-button { color: #9ca3af; }
        .dark .active-tab { color: #a78bfa; border-bottom-color: #a78bfa; }
        .dark .border-gray-200 { border-color: #374151; }
        .dark .bg-white { background-color: #1f2937; }
        
        
        .dark .option-btn { background-color: #374151; color: #f9fafb; border-color: #4b5563; }
        .dark .option-btn:hover:not(.disabled) { background-color: #4b5563; }
        .dark .correct { border: 2px solid #34d399 !important; background-color: #065f46 !important; color: #d1fae5 !important; }
        .dark .incorrect { border: 2px solid #f87171 !important; background-color: #991b1b !important; color: #fee2e2 !important; }
        
        .dark .bg-yellow-100 { background-color: #374151; }
        .dark .text-yellow-800 { color: #facc15; }

        
        #quiz-container h4 {
            color: #1f2937; 
        }
        .dark #quiz-container h4 {
            color: #f9fafb; 
        }
    </style>
    <script>
        if (localStorage.getItem('theme') === 'dark') {
            document.documentElement.classList.add('dark');
        }
    </script>
</head>
<body class="bg-gray-50 text-gray-900">

    <header class="bg-gradient-to-r from-purple-700 to-orange-500 text-white p-4 shadow-md flex justify-between items-center sticky top-0 z-10">
        <h1 class="text-2xl font-bold">Treinamento: Padronização de Processos</h1>
        <a id="back-to-dashboard-link" class="bg-white text-purple-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors duration-300">
            <i class="fas fa-arrow-left mr-2"></i>Voltar ao Painel
        </a>
    </header>

    <main class="p-4 md:p-8 max-w-5xl mx-auto">
        <div id="training-section">
            <div role="tablist" class="flex border-b border-gray-200 bg-white rounded-t-lg shadow-sm">
                <button id="reading-tab" role="tab" class="tab-button active-tab">1. Padronização</button>
                <button id="wellness-tab" role="tab" class="tab-button">2. Reduzir Falhas</button>
            </div>

            <div class="course-card">
                <div id="reading-panel" role="tabpanel">
                    <div class="w-full bg-gray-200 rounded-full h-2.5 mb-6">
                        <div id="progressBarReading" class="progress-bar bg-orange-500 h-2.5 rounded-full w-0"></div>
                    </div>
                    <h2 class="text-4xl font-bold text-gray-800 mb-6">Padronização de Processos: O Que É e Como Fazer</h2>
                    
                    <div class="prose-styling space-y-6">
                        <p>A padronização de processos é uma forma de organizar e melhorar as tarefas em uma empresa.</p>
                        
                        <p><strong>1. Identifique os processos:</strong> Descubra quais são as tarefas importantes que precisam ser feitas.</p>
                        <p><strong>2. Documente os processos:</strong> Escreva como cada tarefa deve ser feita.</p>
                        <p><strong>3. Treine os funcionários:</strong> Ensine os funcionários a seguir os procedimentos padrão.</p>
                        <p><strong>4. Monitore e ajuste:</strong> Verifique se os processos estão sendo seguidos corretamente e faça ajustes quando necessário.</p>

                        <h3>Dicas</h3>
                        <p>- Faça auditorias regulares</p>
                        <p>- Implemente controles de qualidade</p>
                        <p>- Comunique-se com os funcionários</p>
                        
                        <p>A padronização de processos ajuda a melhorar a eficiência e a qualidade em sua empresa.</p>
                    </div>

                    <div class="text-center mt-12 pt-8 border-t border-gray-200">
                        <p class="text-1xl font-bold text-gray-800 mb-6">Você concluiu a primeira parte. Vamos aprender a reduzir falhas!</p>
                        <button id="next-to-wellness-btn" class="w-full md:w-auto inline-flex items-center justify-center px-8 py-3 border border-transparent text-lg font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 transition-transform transform hover:scale-105">
                            Avançar para Reduzir Falhas <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>

                <div id="wellness-panel" role="tabpanel" class="hidden">
                    <div class="w-full bg-gray-200 rounded-full h-2.5 mb-6">
                        <div id="progressBarWellness" class="progress-bar bg-green-500 h-2.5 rounded-full w-0"></div>
                    </div>
                    <h3 class="text-4xl font-bold text-gray-800 mb-6">Como Evitar Falhas</h3>
                    
                    <div class="prose-styling space-y-6">
                        <p><strong>1. Planeje com antecedência:</strong> Antecipe problemas e tenha planos de contingência.</p>
                        <p><strong>2. Verifique e revise:</strong> Verifique os processos e revise-os regularly.</p>
                        <p><strong>3. Treine os funcionários:</strong> Certifique-se de que os funcionários sabem o que fazer.</p>
                        <p><strong>4. Comunique-se:</strong> Comunique-se claramente com os funcionários e departamentos.</p>
                        <p><strong>5. Aprenda com os erros:</strong> Analise os erros e use-os para melhorar.</p>
                        
                        <h3>Dicas Adicionais</h3>
                        <p>- Faça auditorias regulares</p>
                        <p>- Implemente controles de qualidade</p>
                        <p>- Seja proativo em identificar e resolver problemas</p>

                        <p>Ao seguir essas dicas, você pode reduzir a ocorrência de falhas e melhorar a eficiência e a qualidade em sua empresa.</p>
                    </div>
                    
                    <div class="text-center mt-12 pt-8 border-t border-gray-200">
                            <div id="quiz-unlock-message" class="mb-4 p-4 bg-yellow-100 text-yellow-800 rounded-lg">
                                <i class="fas fa-lock mr-2"></i>
                                Role até o final para liberar o teste de conhecimento.
                            </div>
                            <button id="start-quiz-btn" class="w-full md:w-auto inline-flex items-center justify-center px-8 py-4 border border-transparent text-lg font-medium rounded-md text-white transition-transform transform hover:scale-105" disabled>
                                Teste Bloqueado
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="quiz-section" class="hidden course-card">
            <h2 class="text-3xl font-bold text-purple-700 mb-6">Quiz: Padronização e Redução de Falhas</h2>
            <p class="mb-8 text-xl text-gray-600">Selecione a resposta correta em cada pergunta.</p>
            
            <div id="quiz-container" class="space-y-6">
                </div>
            
            <div id="quiz-navigation" class="flex justify-between mt-6 pt-4 border-t border-gray-200">
                </div>
        </div>
        
        <div id="results-section" class="hidden course-card text-center">
            <h2 class="text-3xl font-bold text-purple-700 mb-4">Seus Resultados do Quiz!</h2>
            <div id="score-display" class="text-5xl font-extrabold text-green-600 mb-6"></div>
            <p id="balance-message" class="text-xl text-gray-700 mb-8"></p>
            <a id="finish-training-link" class="bg-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-purple-700 transition-colors duration-300">
                <i class="fas fa-check-circle mr-2"></i> Finalizar Treinamento
            </a>
            <button onclick="window.location.reload()" class="mt-4 px-6 py-3 rounded-md bg-orange-600 text-white hover:bg-orange-700 transition-colors">Refazer Treinamento</button>
        </div>
    </main>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        
        const trainingSection = document.getElementById('training-section');
        const quizSection = document.getElementById('quiz-section');
        const resultsSection = document.getElementById('results-section');
        const quizContainer = document.getElementById('quiz-container');
        const quizNavigation = document.getElementById('quiz-navigation');
        const startQuizBtn = document.getElementById('start-quiz-btn');
        const quizUnlockMessage = document.getElementById('quiz-unlock-message');

        const tabButtons = document.querySelectorAll('.tab-button');
        const readingPanel = document.getElementById('reading-panel');
        const wellnessPanel = document.getElementById('wellness-panel');
        
        const progressBarReading = document.getElementById('progressBarReading');
        const progressBarWellness = document.getElementById('progressBarWellness');
        const nextToWellnessBtn = document.getElementById('next-to-wellness-btn');

        
        // --- NOVO QUIZ: 6 Perguntas (3 de cada aba) ---
        const quizQuestions = [
            // Perguntas da Aba 1: Padronização
            { 
                question: "1. Qual é o primeiro passo da padronização de processos, segundo o texto?", 
                options: [
                    "Treinar os funcionários.",
                    "Identificar os processos.",
                    "Implementar controles de qualidade.",
                    "Monitorar e ajustar."
                ], 
                correct: "Identificar os processos.", 
                explanation: "Correto! O primeiro passo é 'Identifique os processos: Descubra quais são as tarefas importantes'." 
            },
            { 
                question: "2. O que significa 'Documentar os processos'?", 
                options: [
                    "Fazer auditorias regulares.",
                    "Ensinar os funcionários.",
                    "Verificar se os processos estão sendo seguidos.",
                    "Escrever como cada tarefa deve ser feita."
                ], 
                correct: "Escrever como cada tarefa deve ser feita.", 
                explanation: "Exato! A documentação é o ato de registrar o 'como fazer'." 
            },
            { 
                question: "3. Qual das seguintes é listada como uma 'Dica' para a padronização?", 
                options: [
                    "Identificar os processos.",
                    "Aprender com os erros.",
                    "Fazer auditorias regulares.",
                    "Planejar com antecedência."
                ], 
                correct: "Fazer auditorias regulares.", 
                explanation: "Correto, 'Fazer auditorias regulares' é uma das três dicas listadas." 
            },
            // Perguntas da Aba 2: Reduzir Falhas
            { 
                question: "4. Qual é o primeiro passo listado para 'Evitar Falhas'?", 
                options: [
                    "Aprender com os erros.",
                    "Comunique-se.",
                    "Treine os funcionários.",
                    "Planeje com antecedência."
                ], 
                correct: "Planeje com antecedência.", 
                explanation: "O primeiro passo é 'Planeje com antecedência: Antecipe problemas e tenha planos de contingência'." 
            },
            { 
                question: "5. O que a etapa 'Aprenda com os erros' sugere?", 
                options: [
                    "Analisar os erros e usá-los para melhorar.",
                    "Implementar controles de qualidade.",
                    "Ter planos de contingência.",
                    "Verificar os processos regularmente."
                ], 
                correct: "Analisar os erros e usá-los para melhorar.", 
                explanation: "O texto diz exatamente: 'Analise os erros e use-os para melhorar'." 
            },
            { 
                question: "6. Qual das seguintes é uma 'Dica Adicional' para evitar falhas?", 
                options: [
                    "Comunique-se.",
                    "Treine os funcionários.",
                    "Seja proativo em identificar e resolver problemas.",
                    "Documente os processos."
                ], 
                correct: "Seja proativo em identificar e resolver problemas.", 
                explanation: "Ser proativo é uma das três dicas adicionais para evitar falhas." 
            }
        ];
        
        
        let isQuizUnlocked = false;
        let currentQuestionIndex = 0;
        let userAnswers = new Array(quizQuestions.length).fill(null);
        let score = 0;
        const totalQuestions = quizQuestions.length;

        

        function calculateScore() {
            score = userAnswers.filter((answer, index) => answer === quizQuestions[index].correct).length;
        }

        function renderQuestion() {
            if (currentQuestionIndex >= totalQuestions) {
                showResults();
                return;
            }

            quizContainer.innerHTML = '';
            quizNavigation.innerHTML = '';
            const q = quizQuestions[currentQuestionIndex];
            const hasAnswered = userAnswers[currentQuestionIndex] !== null;

            const questionElement = document.createElement('div');
            questionElement.classList.add('fade-in');
            
            let optionsHTML = '';
            q.options.forEach(option => {
                let classes = "option-btn block w-full text-left px-6 py-3 rounded-lg font-medium";
                if (hasAnswered) {
                    classes += ' disabled';
                    if (option === q.correct) {
                        classes += ' correct';
                    } else if (option === userAnswers[currentQuestionIndex]) {
                        classes += ' incorrect';
                    }
                }
                optionsHTML += `<button class="${classes}" data-answer-text="${option}">${option}</button>`;
            });

            let feedbackHTML = '';
            if (hasAnswered) {
                const isCorrect = userAnswers[currentQuestionIndex] === q.correct;
                const colorClass = isCorrect ? 'text-green-800 dark:text-green-400' : 'text-red-800 dark:text-red-400';
                const icon = isCorrect ? '✔️' : '❌';
                feedbackHTML = `<p class="${colorClass}">${icon} ${q.explanation}</p>`;
            }

            questionElement.innerHTML = `
                <h4 class="text-xl font-bold mb-6">${q.question}</h4>
                <div class="options-container space-y-3">${optionsHTML}</div>
                <div class="mt-4 text-center font-bold">${feedbackHTML}</div>
            `;
            quizContainer.appendChild(questionElement);

            if (!hasAnswered) {
                document.querySelectorAll('.option-btn').forEach(btn => {
                    btn.addEventListener('click', checkAnswer);
                });
            }

            renderNavigationButtons();
            window.scrollTo(0, quizSection.offsetTop);
        }

        function checkAnswer(event) {
            const selectedOptionText = event.currentTarget.getAttribute('data-answer-text');
            userAnswers[currentQuestionIndex] = selectedOptionText;
            renderQuestion();
        }

        function renderNavigationButtons() {
            const hasAnswered = userAnswers[currentQuestionIndex] !== null;
            const isLastQuestion = currentQuestionIndex === totalQuestions - 1;

            const backButton = document.createElement('button');
            backButton.innerHTML = `<i class="fas fa-arrow-left mr-2"></i> Voltar`;
            backButton.className = "inline-flex items-center justify-center px-6 py-2 border border-gray-300 text-base font-medium rounded-md text-gray-700 bg-gray-50 hover:bg-gray-200 dark:bg-gray-600 dark:text-gray-100 dark:border-gray-600 dark:hover:bg-gray-700 transition-colors";
            backButton.style.visibility = currentQuestionIndex > 0 ? 'visible' : 'hidden';
            backButton.onclick = () => {
                currentQuestionIndex--;
                renderQuestion();
            };

            const nextButton = document.createElement('button');
            nextButton.innerHTML = isLastQuestion ? `Finalizar <i class="fas fa-check-circle ml-2"></i>` : `Avançar <i class="fas fa-arrow-right ml-2"></i>`;
            nextButton.className = "inline-flex items-center justify-center px-6 py-2 border border-transparent text-base font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 transition-colors";
            nextButton.disabled = !hasAnswered;
            nextButton.onclick = () => {
                if (isLastQuestion) {
                    showResults();
                } else {
                    currentQuestionIndex++;
                    renderQuestion();
                }
            };
            
            quizNavigation.appendChild(backButton);
            quizNavigation.appendChild(nextButton);
        }

        function showResults() {
            calculateScore();
            const scoreDisplay = document.getElementById('score-display');
            const balanceMessage = document.getElementById('balance-message');

            quizSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');

            const percentage = (score / totalQuestions) * 100;
            scoreDisplay.textContent = `${score} / ${totalQuestions}`;
            scoreDisplay.classList.remove('text-green-600', 'text-yellow-600', 'text-red-600');

            if (percentage === 100) {
                balanceMessage.textContent = 'Parabéns! Você demonstrou total domínio sobre Padronização e Redução de Falhas.';
                scoreDisplay.classList.add('text-green-600');
            } else if (percentage >= 75) {
                balanceMessage.textContent = 'Ótimo resultado! Você absorveu a maior parte do conteúdo. Continue se aprimorando!';
                scoreDisplay.classList.add('text-yellow-600');
            } else {
                balanceMessage.textContent = 'Você demonstrou conhecimento, mas pode revisar os módulos para reforçar os conceitos!';
                scoreDisplay.classList.add('text-red-600');
            }
            window.scrollTo(0, resultsSection.offsetTop);
        }

        

        function switchTab(clickedTabId) {
            tabButtons.forEach(button => button.classList.remove('active-tab'));
            if (clickedTabId === 'wellness-tab') {
                document.getElementById('wellness-tab').classList.add('active-tab');
                readingPanel.classList.add('hidden');
                wellnessPanel.classList.remove('hidden');
            } else {
                document.getElementById('reading-tab').classList.add('active-tab');
                wellnessPanel.classList.add('hidden');
                readingPanel.classList.remove('hidden');
            }
            window.scrollTo(0, 0);
        }

        function updateActiveTabProgress() {
            const scrollPosition = window.scrollY;
            const clientHeight = document.documentElement.clientHeight;
            const trainingContainer = document.getElementById('training-section');
            if (!trainingContainer) return; 

            const trainingHeight = trainingContainer.offsetHeight;
            const trainingScrollTop = scrollPosition - trainingContainer.offsetTop;
            const maxTrainingScroll = (trainingHeight > clientHeight) ? (trainingHeight - clientHeight) : 1;
            const progressInTraining = Math.min(Math.max(0, trainingScrollTop) / maxTrainingScroll, 1) * 100;

            if (!readingPanel.classList.contains('hidden')) {
                progressBarReading.style.width = Math.min(progressInTraining, 100) + '%';
            } else if (!wellnessPanel.classList.contains('hidden') && !isQuizUnlocked) {
                progressBarWellness.style.width = Math.min(progressInTraining, 100) + '%';
                if (Math.min(progressInTraining, 100) >= 95) { 
                    isQuizUnlocked = true;
                    startQuizBtn.disabled = false;
                    startQuizBtn.textContent = 'Estou pronto para o teste!';
                    startQuizBtn.classList.add('bg-green-600', 'hover:bg-green-700');
                    quizUnlockMessage.style.display = 'none';
                }
            }
        }

        

        tabButtons.forEach(button => button.addEventListener('click', () => switchTab(button.id)));
        nextToWellnessBtn.addEventListener('click', () => switchTab('wellness-tab'));
        startQuizBtn.addEventListener('click', () => {
            if (isQuizUnlocked) {
                trainingSection.classList.add('hidden');
                quizSection.classList.remove('hidden');
                currentQuestionIndex = 0;
                userAnswers.fill(null);
                score = 0;
                renderQuestion();
            }
        });

        function throttle(func, limit) {
            let inThrottle;
            return function(...args) {
                if (!inThrottle) {
                    func.apply(this, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            }
        }
        window.addEventListener('scroll', throttle(updateActiveTabProgress, 100));

        const backLink = document.getElementById('back-to-dashboard-link');
        if (backLink) {
            const userRole = localStorage.getItem('userRole');
            backLink.href = (userRole === 'Empresa') ? "Empresa.html" : "painel.html";
        }

        const finishTrainingLink = document.getElementById('finish-training-link');
        if (finishTrainingLink) {
            const userRole = localStorage.getItem('userRole');
            finishTrainingLink.href = (userRole === 'Empresa') ? "Empresa.html" : "painel.html";
        }
    });
    </script>
</body>
</html>